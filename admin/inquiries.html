<!DOCTYPE html>
<html>
<head>
  <title>Inquiry Management | Yug Enterprise</title>
  <style>
    body{margin:0;font-family:Arial;background:#f4f6f8}
    .header{
      background:#1f2937;
      color:white;
      padding:15px 30px;
      display:flex;
      justify-content:space-between;
    }
    .layout{display:flex}
    .sidebar{
      width:220px;
      background:#111827;
      color:white;
      height:100vh;
    }
    .sidebar a{
      display:block;
      padding:14px 20px;
      color:#d1d5db;
      text-decoration:none;
    }
    .sidebar a:hover{
      background:#1f2937;
      color:white;
    }
    .content{flex:1;padding:30px}
    table{
      width:100%;
      border-collapse:collapse;
      background:white;
    }
    th,td{
      padding:12px;
      border-bottom:1px solid #eee;
      text-align:left;
    }
    th{background:#f9fafb}
    button{
      padding:6px 12px;
      border:none;
      border-radius:4px;
      cursor:pointer;
    }
    .delBtn{
      background:#ef4444;
      color:white;
    }
  </style>
</head>
<body>

<div class="header">
  <h2>Inquiry Management</h2>
  <button onclick="logout()">Logout</button>
</div>

<div class="layout">
  <div class="sidebar">
    <a href="dashboard.html">ðŸ“Š Dashboard</a>
    <a href="inquiries.html">ðŸ“© Inquiries</a>
    <a href="products.html">ðŸ“¦ Products</a>
  </div>

  <div class="content">
    <h3>All Inquiries</h3>

    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>Message</th>
          <th>Date</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="rows"></tbody>
    </table>

  </div>
</div>

<script>
const token = localStorage.getItem("token");
if(!token) location.href="login.html";

/* LOAD INQUIRIES */
function loadInquiries(){
  fetch("http://localhost:5000/api/inquiries",{
    headers:{
      "Authorization":"Bearer "+token
    }
  })
  .then(res=>res.json())
  .then(data=>{
    const rows=document.getElementById("rows");
    rows.innerHTML="";

    data.forEach(i=>{
      rows.innerHTML+=`
        <tr>
          <td>${i.name}</td>
          <td>${i.email}</td>
          <td>${i.message}</td>
          <td>${new Date(i.createdAt).toLocaleString()}</td>
          <td>
            <button class="delBtn" onclick="deleteInquiry('${i._id}')">
              Delete
            </button>
          </td>
        </tr>
      `;
    });
  })
  .catch(()=>alert("Server not responding"));
}

/* DELETE INQUIRY */
function deleteInquiry(id){
  if(confirm("Are you sure to delete this inquiry?")){
    fetch(`http://localhost:5000/api/inquiries/${id}`,{
      method:"DELETE",
      headers:{
        "Authorization":"Bearer "+token
      }
    })
    .then(res=>res.json())
    .then(data=>{
      if(data.success){
        loadInquiries();
      }
    });
  }
}

function logout(){
  localStorage.removeItem("token");
  location.href="login.html";
}

loadInquiries();
</script>

</body>
</html>